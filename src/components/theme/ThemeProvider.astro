<script is:inline>
  const theme = (() => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme'))
      return localStorage.getItem('theme')

    if (window.matchMedia('(prefers-color-scheme: dark)').matches) return 'dark'
    else return 'light'
  })()

  function setTheme(theme) {
    if (theme === 'light') document.documentElement.classList.remove('dark')
    else document.documentElement.classList.add('dark')

    window.localStorage.setItem('theme', theme)
  }

  setTheme()
  document.addEventListener('astro:after-swap', setTheme(theme))
</script>
